# MVPでの認証方式の検討メモ

## 結論
- **MVP時点では Rails標準のパスワード認証を採用する**
- マジックリンクの機能追加は一旦検討保留とする
  - MVP後も、パスワード認証を主要なログイン方法としつつ、オプションとしてマジックリンク機能追加する可能性があるが、主要な判断理由の3の記載より、本サービスとのかみ合わせが悪いためおそらく実装しない

---

## 背景
ToneTwo は「心理的安全性の高い匿名性掲示板」を目指すため、当初は **パスワードレス（マジックリンク）** を第一候補として検討していた。
ただし、MVPの優先順位と運用リスクを踏まえ、認証方式を再検討した。

---

## 主要な判断理由

### 1) メールアドレス入力がある時点で心理的抵抗感は残る
- 匿名性サービスにおける心理的抵抗の本丸は、パスワードそのものより **メールアドレスを提供すること**にある。
- マジックリンクにしても、ログイン（または登録）時に **メールアドレス入力が必須**なら、抵抗感は大きくは変わりにくい。
- そのため「パスワードレス＝心理的安全性が大きく上がる」とは言い切れず、MVPで優先する決定打にはなりにくい。

### 2) メールサーバ障害がログイン不能に直結する（単一障害点）
- パスワード認証：メールが必要なのは主に **例外系**（パスワードリセット等）
- マジックリンク：メールが必要なのは **通常系**（ログインそのもの）
- したがって、メール配信の遅延・迷惑メール判定・プロバイダ側制限・送信サービス障害が起きると、
  - **マジックリンクは全ユーザーがログイン不能になり得る**
  - パスワード認証は既存ユーザーのログイン自体は維持できる（影響範囲が限定されやすい）
- MVPではメールサーバーの運用体制が薄い前提のため、ログインがメールに依存する設計はリスクが高い。

### 3) リダイレクト前提のUXが微妙（導線が長い/失敗しやすい）
- マジックリンクは基本的に「メールを開く → リンクを踏む → ブラウザへ戻る」という導線になる。
- この導線は、
  - アプリ/メールクライアント/ブラウザの切り替え
  - 端末・ブラウザ跨ぎ（PCで登録してスマホでメールを開く等）
  - 二重クリック/再送/期限切れ
  といった失敗要因が増え、MVP段階ではユーザー体験が不安定になりやすい。
- 一方、パスワード認証は「その場で入力→ログイン」で完結し、導線が短い。
- パスワードリセットが頻発する（再ログインまで期間が空くなど）の場合はマジックリンクにUXの軍配が上がるが、本サービスのように頻繁にログインを期待するサービスの場合、むしろリダイレクト前提であることがUXを下げると判断した

---

## 補足（MVPでのメール機能の位置づけ）
- MVPでもメール機能（例：メールアドレス確認、通知）は入れたいが、
  - **ログイン自体をメール依存にしない**
  - メール運用（到達性、失敗時導線、ワーカー運用）を “通知” で先に育てる
  という段階設計の方が安全。
- Active Job + Solid Queue などで `deliver_later` 運用を整えるが、これは **通知の品質向上**に使い、
  認証そのものはパスワード方式で安定させる。

---
